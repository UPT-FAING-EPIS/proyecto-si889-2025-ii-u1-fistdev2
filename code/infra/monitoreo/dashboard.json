{
  "title": "DevFlow - Dashboard Principal",
  "description": "Dashboard principal para monitoreo del sistema DevFlow",
  "version": "1.0.0",
  "created": "2024-09-11T00:00:00Z",
  "widgets": [
    {
      "id": "system-overview",
      "type": "overview",
      "title": "Resumen del Sistema",
      "position": { "x": 0, "y": 0, "w": 12, "h": 3 },
      "metrics": [
        {
          "name": "Usuarios Activos",
          "query": "count(distinct(user_sessions{status='active'}))",
          "format": "number",
          "color": "#3b82f6"
        },
        {
          "name": "Proyectos Totales",
          "query": "count(projects{status!='deleted'})",
          "format": "number",
          "color": "#10b981"
        },
        {
          "name": "Tareas Completadas Hoy",
          "query": "count(tasks{status='done', completed_date=today()})",
          "format": "number",
          "color": "#f59e0b"
        },
        {
          "name": "Uptime del Sistema",
          "query": "avg(up{job='devflow-backend'})",
          "format": "percent",
          "color": "#ef4444"
        }
      ]
    },
    {
      "id": "response-times",
      "type": "timeseries",
      "title": "Tiempos de Respuesta",
      "position": { "x": 0, "y": 3, "w": 6, "h": 4 },
      "query": "histogram_quantile(0.95, rate(http_request_duration_seconds_bucket{job='devflow-backend'}[5m]))",
      "yAxis": {
        "label": "Tiempo (segundos)",
        "min": 0,
        "max": "auto"
      },
      "series": [
        {
          "name": "P95 Response Time",
          "color": "#3b82f6"
        }
      ],
      "thresholds": [
        {
          "value": 1.0,
          "color": "#f59e0b",
          "label": "Warning"
        },
        {
          "value": 2.0,
          "color": "#ef4444",
          "label": "Critical"
        }
      ]
    },
    {
      "id": "request-rate",
      "type": "timeseries",
      "title": "Tasa de Requests",
      "position": { "x": 6, "y": 3, "w": 6, "h": 4 },
      "query": "rate(http_requests_total{job='devflow-backend'}[5m])",
      "yAxis": {
        "label": "Requests/segundo",
        "min": 0
      },
      "series": [
        {
          "name": "Request Rate",
          "color": "#10b981"
        }
      ]
    },
    {
      "id": "error-rate",
      "type": "singlestat",
      "title": "Tasa de Errores",
      "position": { "x": 0, "y": 7, "w": 3, "h": 3 },
      "query": "rate(http_requests_total{status=~'5..', job='devflow-backend'}[5m]) / rate(http_requests_total{job='devflow-backend'}[5m]) * 100",
      "format": "percent",
      "thresholds": [
        {
          "value": 1,
          "color": "#f59e0b"
        },
        {
          "value": 5,
          "color": "#ef4444"
        }
      ]
    },
    {
      "id": "cpu-usage",
      "type": "gauge",
      "title": "Uso de CPU",
      "position": { "x": 3, "y": 7, "w": 3, "h": 3 },
      "query": "avg(cpu_usage{container='devflow-backend'}) * 100",
      "format": "percent",
      "min": 0,
      "max": 100,
      "thresholds": [
        {
          "value": 70,
          "color": "#f59e0b"
        },
        {
          "value": 90,
          "color": "#ef4444"
        }
      ]
    },
    {
      "id": "memory-usage",
      "type": "gauge",
      "title": "Uso de Memoria",
      "position": { "x": 6, "y": 7, "w": 3, "h": 3 },
      "query": "avg(memory_usage{container='devflow-backend'}) * 100",
      "format": "percent",
      "min": 0,
      "max": 100,
      "thresholds": [
        {
          "value": 80,
          "color": "#f59e0b"
        },
        {
          "value": 95,
          "color": "#ef4444"
        }
      ]
    },
    {
      "id": "database-connections",
      "type": "singlestat",
      "title": "Conexiones DB",
      "position": { "x": 9, "y": 7, "w": 3, "h": 3 },
      "query": "pg_stat_activity_count{database='devflow'}",
      "format": "number",
      "thresholds": [
        {
          "value": 50,
          "color": "#f59e0b"
        },
        {
          "value": 80,
          "color": "#ef4444"
        }
      ]
    },
    {
      "id": "top-endpoints",
      "type": "table",
      "title": "Endpoints MÃ¡s Utilizados",
      "position": { "x": 0, "y": 10, "w": 6, "h": 4 },
      "query": "topk(10, sum by (endpoint) (rate(http_requests_total{job='devflow-backend'}[1h])))",
      "columns": [
        {
          "name": "Endpoint",
          "field": "endpoint"
        },
        {
          "name": "Requests/h",
          "field": "value",
          "format": "number"
        }
      ]
    },
    {
      "id": "user-activity",
      "type": "timeseries",
      "title": "Actividad de Usuarios",
      "position": { "x": 6, "y": 10, "w": 6, "h": 4 },
      "query": "count by (action) (rate(user_actions_total{job='devflow-backend'}[5m]))",
      "yAxis": {
        "label": "Acciones/minuto"
      },
      "series": [
        {
          "name": "Login",
          "color": "#3b82f6"
        },
        {
          "name": "Create Project",
          "color": "#10b981"
        },
        {
          "name": "Create Task",
          "color": "#f59e0b"
        }
      ]
    },
    {
      "id": "alert-status",
      "type": "alert-list",
      "title": "Alertas Activas",
      "position": { "x": 0, "y": 14, "w": 12, "h": 3 },
      "showResolved": false,
      "severityFilter": ["critical", "high", "medium"],
      "columns": [
        "severity",
        "alertname",
        "description",
        "started",
        "duration"
      ]
    }
  ],
  "refresh": "30s",
  "timeRange": {
    "from": "now-6h",
    "to": "now"
  },
  "templates": [
    {
      "name": "environment",
      "type": "constant",
      "value": "production"
    },
    {
      "name": "instance",
      "type": "query",
      "query": "label_values(up{job='devflow-backend'}, instance)"
    }
  ],
  "annotations": [
    {
      "name": "Deployments",
      "enabled": true,
      "query": "deployment_events{environment='$environment'}",
      "color": "#3b82f6"
    },
    {
      "name": "Incidents",
      "enabled": true,
      "query": "incident_events{severity!='low'}",
      "color": "#ef4444"
    }
  ],
  "links": [
    {
      "title": "Logs",
      "url": "http://localhost:3003/explore?datasource=loki&query={job='devflow-backend'}"
    },
    {
      "title": "Traces",
      "url": "http://localhost:3003/explore?datasource=jaeger"
    }
  ]
}
