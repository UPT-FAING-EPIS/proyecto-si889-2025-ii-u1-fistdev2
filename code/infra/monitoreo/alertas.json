{
  "alerts": [
    {
      "id": "high-response-time",
      "name": "Alto Tiempo de Respuesta",
      "description": "El tiempo de respuesta P95 est치 por encima del umbral",
      "severity": "warning",
      "condition": {
        "query": "histogram_quantile(0.95, rate(http_request_duration_seconds_bucket{job='devflow-backend'}[5m]))",
        "operator": ">",
        "threshold": 1.0,
        "duration": "5m"
      },
      "actions": [
        {
          "type": "email",
          "recipients": ["admin@devflow.com", "ops@devflow.com"],
          "subject": "DevFlow: Alto tiempo de respuesta detectado",
          "template": "high_response_time"
        },
        {
          "type": "slack",
          "channel": "#alerts",
          "message": "游뚿 Alto tiempo de respuesta en DevFlow: {{$value}}s"
        }
      ],
      "enabled": true
    },
    {
      "id": "critical-response-time",
      "name": "Tiempo de Respuesta Cr칤tico",
      "description": "El tiempo de respuesta P95 est치 en nivel cr칤tico",
      "severity": "critical",
      "condition": {
        "query": "histogram_quantile(0.95, rate(http_request_duration_seconds_bucket{job='devflow-backend'}[5m]))",
        "operator": ">",
        "threshold": 3.0,
        "duration": "2m"
      },
      "actions": [
        {
          "type": "pagerduty",
          "service_key": "devflow-critical",
          "message": "CR칈TICO: Tiempo de respuesta muy alto en DevFlow"
        },
        {
          "type": "email",
          "recipients": ["admin@devflow.com", "ops@devflow.com"],
          "subject": "CR칈TICO: DevFlow tiempo de respuesta",
          "template": "critical_response_time"
        }
      ],
      "enabled": true
    },
    {
      "id": "high-error-rate",
      "name": "Alta Tasa de Errores",
      "description": "La tasa de errores 5xx est치 por encima del 5%",
      "severity": "critical",
      "condition": {
        "query": "(rate(http_requests_total{status=~'5..', job='devflow-backend'}[5m]) / rate(http_requests_total{job='devflow-backend'}[5m])) * 100",
        "operator": ">",
        "threshold": 5.0,
        "duration": "3m"
      },
      "actions": [
        {
          "type": "slack",
          "channel": "#alerts",
          "message": "游댠 Alta tasa de errores en DevFlow: {{$value}}%"
        },
        {
          "type": "email",
          "recipients": ["admin@devflow.com"],
          "subject": "DevFlow: Alta tasa de errores detectada"
        }
      ],
      "enabled": true
    },
    {
      "id": "service-down",
      "name": "Servicio Ca칤do",
      "description": "El backend de DevFlow no est치 respondiendo",
      "severity": "critical",
      "condition": {
        "query": "up{job='devflow-backend'}",
        "operator": "==",
        "threshold": 0,
        "duration": "30s"
      },
      "actions": [
        {
          "type": "pagerduty",
          "service_key": "devflow-critical",
          "message": "CR칈TICO: Servicio DevFlow backend est치 ca칤do"
        },
        {
          "type": "slack",
          "channel": "#alerts",
          "message": "游뚿 SERVICIO CA칈DO: DevFlow backend no responde"
        }
      ],
      "enabled": true
    },
    {
      "id": "high-cpu-usage",
      "name": "Alto Uso de CPU",
      "description": "El uso de CPU est치 por encima del 85%",
      "severity": "warning",
      "condition": {
        "query": "avg(cpu_usage{container='devflow-backend'}) * 100",
        "operator": ">",
        "threshold": 85,
        "duration": "10m"
      },
      "actions": [
        {
          "type": "email",
          "recipients": ["ops@devflow.com"],
          "subject": "DevFlow: Alto uso de CPU"
        }
      ],
      "enabled": true
    },
    {
      "id": "high-memory-usage",
      "name": "Alto Uso de Memoria",
      "description": "El uso de memoria est치 por encima del 90%",
      "severity": "critical",
      "condition": {
        "query": "avg(memory_usage{container='devflow-backend'}) * 100",
        "operator": ">",
        "threshold": 90,
        "duration": "5m"
      },
      "actions": [
        {
          "type": "slack",
          "channel": "#alerts",
          "message": "丘멆잺 Alto uso de memoria en DevFlow: {{$value}}%"
        },
        {
          "type": "email",
          "recipients": ["ops@devflow.com"],
          "subject": "DevFlow: Alto uso de memoria"
        }
      ],
      "enabled": true
    },
    {
      "id": "database-connection-exhaustion",
      "name": "Agotamiento de Conexiones DB",
      "description": "Las conexiones a la base de datos est치n cerca del l칤mite",
      "severity": "warning",
      "condition": {
        "query": "pg_stat_activity_count{database='devflow'}",
        "operator": ">",
        "threshold": 150,
        "duration": "5m"
      },
      "actions": [
        {
          "type": "slack",
          "channel": "#alerts",
          "message": "游늵 Alto n칰mero de conexiones DB: {{$value}}"
        }
      ],
      "enabled": true
    },
    {
      "id": "disk-space-low",
      "name": "Poco Espacio en Disco",
      "description": "El espacio en disco est치 por debajo del 20%",
      "severity": "warning",
      "condition": {
        "query": "(disk_free{mount='/'} / disk_total{mount='/'}) * 100",
        "operator": "<",
        "threshold": 20,
        "duration": "1m"
      },
      "actions": [
        {
          "type": "email",
          "recipients": ["ops@devflow.com"],
          "subject": "DevFlow: Poco espacio en disco"
        }
      ],
      "enabled": true
    },
    {
      "id": "failed-deployments",
      "name": "Deployment Fallido",
      "description": "Se detect칩 un deployment fallido",
      "severity": "high",
      "condition": {
        "query": "deployment_status{status='failed'}",
        "operator": ">",
        "threshold": 0,
        "duration": "1m"
      },
      "actions": [
        {
          "type": "slack",
          "channel": "#deployments",
          "message": "游눤 Deployment fallido detectado en DevFlow"
        },
        {
          "type": "email",
          "recipients": ["dev@devflow.com"],
          "subject": "DevFlow: Deployment fallido"
        }
      ],
      "enabled": true
    },
    {
      "id": "redis-connection-failed",
      "name": "Conexi칩n Redis Fallida",
      "description": "No se puede conectar a Redis",
      "severity": "high",
      "condition": {
        "query": "redis_up{instance='devflow-redis'}",
        "operator": "==",
        "threshold": 0,
        "duration": "30s"
      },
      "actions": [
        {
          "type": "slack",
          "channel": "#alerts",
          "message": "游댮 Redis no disponible en DevFlow"
        }
      ],
      "enabled": true
    }
  ],
  "notification_channels": [
    {
      "name": "email-ops",
      "type": "email",
      "settings": {
        "smtp_host": "smtp.gmail.com",
        "smtp_port": 587,
        "from": "alerts@devflow.com",
        "username": "alerts@devflow.com",
        "password": "${EMAIL_PASSWORD}",
        "starttls": true
      }
    },
    {
      "name": "slack-alerts",
      "type": "slack",
      "settings": {
        "webhook_url": "${SLACK_WEBHOOK_URL}",
        "channel": "#alerts",
        "username": "DevFlow Alerts"
      }
    },
    {
      "name": "pagerduty-critical",
      "type": "pagerduty",
      "settings": {
        "integration_key": "${PAGERDUTY_INTEGRATION_KEY}",
        "service_name": "DevFlow"
      }
    }
  ],
  "escalation_policies": [
    {
      "name": "standard-escalation",
      "steps": [
        {
          "timeout": "5m",
          "channels": ["slack-alerts"]
        },
        {
          "timeout": "15m",
          "channels": ["email-ops"]
        },
        {
          "timeout": "30m",
          "channels": ["pagerduty-critical"]
        }
      ]
    }
  ],
  "maintenance_windows": [
    {
      "name": "weekly-maintenance",
      "description": "Ventana de mantenimiento semanal",
      "schedule": {
        "day_of_week": "sunday",
        "start_time": "02:00",
        "duration": "4h",
        "timezone": "UTC"
      },
      "alerts_suppressed": [
        "high-response-time",
        "service-down"
      ]
    }
  ],
  "global_settings": {
    "resolve_timeout": "5m",
    "group_wait": "30s",
    "group_interval": "5m",
    "repeat_interval": "12h",
    "inhibit_rules": [
      {
        "source_match": {
          "severity": "critical"
        },
        "target_match": {
          "severity": "warning"
        },
        "equal": ["alertname", "instance"]
      }
    ]
  }
}
